<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Gr&aacute;fico de Infracciones de Transito</title>
</head>
<link rel="stylesheet" href="./lib/bootstrap/dist/css/bootstrap.css" />
<link rel="stylesheet" href="./lib/leaflet/dist/leaflet.css" />
<link rel="stylesheet" href="./css/jquery.dataTables.min.css" />
<!-- <script type="text/javascript" src="./lib/jQuery/dist/jquery.min.js"></script> -->
<script type="text/javascript" src="./lib/jquery-1.12.0.min.js"></script>
<script type="text/javascript"
	src="./lib/bootstrap/dist/js/bootstrap.js"></script>
<script type="text/javascript" src="./lib/leaflet/dist/leaflet.js"></script>
<script type="text/javascript" src="./lib/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="./lib/py-dptos.js" ></script>


<style>
#map {
	margin: 0 auto;
}
.td-title{
	font-weight: bold;
}
</style>
<body>

	<div class="container">
		<h3>Infracciones de Transitos</h3>
		<ul class="nav nav-tabs">
			<li class="active"><a data-toggle='tab' href="#mapa">Mapa</a></li>
			<li><a data-toggle='tab' href="#datos">Datos</a></li>
		</ul>
		<br>
	</div>
	<div class="tab-content">
		<div id="mapa" class="tab-pane fade in active">
			<div id="map" style="width: 650px; height: 450px;"></div>
		</div>
		<div id="datos" class="tab-pane fade in text-center">
			<div class="row">
				<div class="col-md-2"></div>
				<div class="col-md-8">
					<table id="tbl-multas"
						class="display  table table-striped table-bordered table-hover"
						width="100%" cellspacing="0">
						<thead>
							<tr>
								<th>Multa</th>
								<th>Cod. Sancion</th>
								<th>Descripcion</th>
								<th>Tipo Vehiculo</th>
								
							</tr>
						</thead>
						<tfoot>
							<tr>
								<th>Multa</th>
								<th>Cod. Sancion</th>
								<th>Descripcion</th>
								<th>Tipo Vehiculo</th>
								
							</tr>

						</tfoot>
					</table>
				</div>
				<div class="col-md-2"></div>
			</div>
		</div>
	</div>


	<script type="text/javascript">
	$('document').ready(function(){
		var osmUrl='http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';
		var osm = new L.TileLayer(osmUrl, {minZoom: 1, maxZoom: 50});		
		var map = L.map('map').setView([-23.4510191,-58.0437109	], 6);
		map.addLayer(osm);
		// Disable drag and zoom handlers.
// 			map.dragging.disable();
// 			map.touchZoom.disable();
// 			map.doubleClickZoom.disable();
// 			map.scrollWheelZoom.disable();
// 			map.keyboard.disable();
		map.on('load',function(){
			alert('cargando....');
		});
		
			L.geoJson(statesData,{
				style:function(feature){
						return feature.properties.style;
					},
					onEachFeature: function (feature, layer){
						layer.bindPopup(createPopup(feature.properties.name,feature.properties.cantidad));
						}
				}).addTo(map);

			loadTable();
		}	
	
	);

	function loadTable(){
		
		$("#tbl-multas").DataTable(
				{
					"pagingType" : "full_numbers",
		 	        "processing": true,
		 	        "serverSide": true,
		 	        "ajax": {
		 	            "url": "datos.jsp",
		 	            "type": "POST"
		 	        },
		 	       "columns": [
		 	                  { "data": "idMulta" },
		 	                  { "data": "codigoSancion" },
		 	                  { "data": "descripcion" },
		 	                  { "data": "tipoVehiculo" }
		 	                  
		 	              ]
		 	         ,
					language : {
						"sProcessing" : "Procesando...",
						"sLengthMenu" : "Mostrar _MENU_ registros",
						"sZeroRecords" : "No se encontraron resultados",
						"sEmptyTable" : "Ningún dato disponible en esta tabla",
						"sInfo" : "Mostrando registros del _START_ al _END_ de un total de _TOTAL_ registros",
						"sInfoEmpty" : "Mostrando registros del 0 al 0 de un total de 0 registros",
						"sInfoFiltered" : "(filtrado de un total de _MAX_ registros)",
						"sInfoPostFix" : "",
						"sSearch" : "Buscar:",
						"sUrl" : "",
						"sInfoThousands" : ",",
						"sLoadingRecords" : "Cargando...",
						"oPaginate" : {
							"sFirst" : "Primero",
							"sLast" : "Último",
							"sNext" : "Siguiente",
							"sPrevious" : "Anterior"
						},
						"oAria" : {
							"sSortAscending" : ": Activar para ordenar la columna de manera ascendente",
							"sSortDescending" : ": Activar para ordenar la columna de manera descendente"
						}
					}
				});
		}

	function createPopup(dpto, cantidad){
			var table = "<table class='table table-striped table-condensed' > ";
			table += "<tr> <td class='td-title'> Departamento </td>";
			table += " <td > "+dpto+" </td> </tr>";
			table += "<tr> <td class='td-title'> Cantidad de Infracciones </td>";
			table += " <td> "+cantidad+" </td> </tr>";
			table += "</table>";
			return table;
		}

	

</script>
</body>
</html>
